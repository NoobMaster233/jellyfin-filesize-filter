<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>文件大小过滤器</title>
</head>
<body>
<div class="page type-interior pluginConfigurationPage FileSizeFilterConfigurationPage" data-require="emby-input,emby-button,emby-checkbox" data-role="page">
    <div data-role="content">
        <div class="content-primary">

            <h1>文件大小过滤器</h1>

            <div class="readOnlyContent">
                <p class="description1">根据文件大小过滤影音库中的文件，避免扫描小文件（如预览图、字幕文件等）。</p>
            </div>

            <form class="FileSizeFilterConfigurationForm">

                <div class="verticalSection">
                    <h2>基本设置</h2>

                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="chkEnabled" is="emby-checkbox" name="chkEnabled" type="checkbox"/>
                            <span>启用文件大小过滤</span>
                        </label>
                        <div class="fieldDescription checkboxFieldDescription">勾选此选项以启用基于文件大小的过滤功能</div>
                    </div>

                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="txtMinFileSizeMB">最小文件大小阈值 (MB):</label>
                        <input id="txtMinFileSizeMB" is="emby-input" name="txtMinFileSizeMB" min="1" max="10000" step="1" type="number"/>
                        <div class="fieldDescription">小于此大小的文件将被从影音库中隐藏（推荐100-500MB）</div>
                    </div>
                </div>

                <div>
                    <button class="raised button-submit block" is="emby-button" type="submit">
                        <span>保存</span>
                    </button>
                </div>

            </form>
        </div>
    </div>
    <script type="text/javascript">
        var FileSizeFilterPluginConfig = {
            pluginUniqueId: "6ac83d8b-8a8c-4f4e-9b7c-2d5e8f4a3b1c"
        };

        $('.FileSizeFilterConfigurationPage').on('pageshow', function () {
            Dashboard.showLoadingMsg();
            var page = this;
            ApiClient.getPluginConfiguration(FileSizeFilterPluginConfig.pluginUniqueId).then(function (config) {
                page.querySelector('#chkEnabled').checked = config.Enabled;
                $('#txtMinFileSizeMB', page).val(config.MinFileSizeMB).change();
                Dashboard.hideLoadingMsg();
            });
        });

        $('.FileSizeFilterConfigurationForm').on('submit', function () {
            Dashboard.showLoadingMsg();
            var form = this;
            ApiClient.getPluginConfiguration(FileSizeFilterPluginConfig.pluginUniqueId).then(function (config) {
                config.Enabled = $('#chkEnabled', form).prop('checked');
                config.MinFileSizeMB = parseInt($('#txtMinFileSizeMB', form).val()) || 100;
                ApiClient.updatePluginConfiguration(FileSizeFilterPluginConfig.pluginUniqueId, config).then(Dashboard.processPluginConfigurationUpdateResult);
            });
            // Disable default form submission
            return false;
        });
    </script>
</div>
</body>
</html> 